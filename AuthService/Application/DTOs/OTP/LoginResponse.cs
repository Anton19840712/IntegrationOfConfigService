namespace Application.DTOs.OTP
{
    /// <summary>
    /// Модель ответа на запрос аутентификации пользователя в системе
    /// </summary>
    /// <remarks>
    /// <para>
    /// Содержит результаты попытки входа и необходимые токены для доступа к защищенным ресурсам.
    /// Может использоваться в различных сценариях аутентификации:
    /// - Прямой вход (когда двухфакторная аутентификация не требуется)
    /// - Первый этап двухфакторной аутентификации
    /// - Обновление токенов доступа
    /// </para>
    /// <para>
    /// <b>Безопасность:</b> AccessToken имеет ограниченное время жизни, RefreshToken должен храниться безопасно
    /// и использоваться только для получения новых AccessToken. При передаче по сети рекомендуется использовать HTTPS.
    /// </para>
    /// </remarks>
    public class LoginResponse
    {
        /// <summary>
        /// Флаг, указывающий на необходимость подтверждения через одноразовый пароль (OTP)
        /// </summary>
        /// <value>
        /// true - требуется дополнительная аутентификация через OTP (двухфакторная аутентификация)
        /// false - пользователь успешно аутентифицирован, токены доступа доступны
        /// </value>
        /// <example>true</example>
        public bool IsOtpRequired { get; set; }

        /// <summary>
        /// Уникальный идентификатор пользователя в системе
        /// </summary>
        /// <value>
        /// Guid пользователя. Может быть null если аутентификация не завершена (требуется OTP)
        /// или если произошла ошибка аутентификации.
        /// </value>
        /// <example>"a1b2c3d4-e5f6-7890-abcd-ef1234567890"</example>
        public Guid? UserId { get; set; }

        /// <summary>
        /// Токен доступа для авторизации запросов к защищенным API
        /// </summary>
        /// <value>
        /// JWT токен в формате строки. Содержит claims пользователя и метаданные сессии.
        /// Имеет ограниченное время жизни (обычно 15-60 минут).
        /// </value>
        /// <example>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."</example>
        public string AccessToken { get; set; }

        /// <summary>
        /// Токен для обновления AccessToken по истечении его срока действия
        /// </summary>
        /// <value>
        /// Строка, представляющая долгоживущий токен обновления. Используется для получения
        /// новых AccessToken без повторного ввода учетных данных пользователя.
        /// </value>
        public string RefreshToken { get; set; }
    }
}
