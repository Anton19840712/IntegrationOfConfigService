namespace Application.DTOs.OTP
{
    /// <summary>
    /// Модель запроса для верификации одноразового пароля (OTP) на втором этапе аутентификации
    /// </summary>
    /// <remarks>
    /// <para>
    /// Используется после успешной первичной аутентификации, когда требуется подтверждение
    /// через двухфакторную аутентификацию. Связывает OTP с конкретным пользователем для
    /// предотвращения атак подмены пользователя.
    /// </para>
    /// <para>
    /// <b>Безопасность:</b> UserId должен соответствовать пользователю, который инициировал
    /// запрос OTP. Рекомендуется проверять соответствие сессии и временные ограничения
    /// на использование OTP (обычно 5-10 минут).
    /// </para>
    /// </remarks>
    public class VerifyOtpRequest
    {
        /// <summary>
        /// Уникальный идентификатор пользователя, для которого выполняется верификация OTP
        /// </summary>
        /// <value>
        /// Guid пользователя, полученный на первом этапе аутентификации. Должен соответствовать
        /// пользователю, которому был отправлен OTP код.
        /// </value>
        /// <example>"a1b2c3d4-e5f6-7890-abcd-ef1234567890"</example>
        /// <exception cref="ArgumentException">Генерируется при передаче пустого Guid</exception>
        public Guid UserId { get; set; }

        /// <summary>
        /// Одноразовый пароль (One-Time Password), введенный пользователем для подтверждения аутентификации
        /// </summary>
        /// <value>
        /// Строка, содержащая цифровой код подтверждения. Обычно состоит из 4-6 цифр.
        /// Должен совпадать с кодом, отправленным пользователю на втором этапе аутентификации.
        /// </value>
        /// <example>"123456"</example>
        /// <exception cref="ArgumentNullException">Генерируется при попытке установить null значение</exception>
        /// <exception cref="ArgumentException">Генерируется при передаче пустой строки или кода неверной длины</exception>
        public string Otp { get; set; }
    }
}
